"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[418],{3905:(e,t,r)=>{r.d(t,{Zo:()=>s,kt:()=>u});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},s=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),m=c(r),h=a,u=m["".concat(l,".").concat(h)]||m[h]||d[h]||o;return r?n.createElement(u,i(i({ref:t},s),{},{components:r})):n.createElement(u,i({ref:t},s))}));function u(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=h;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[m]="string"==typeof e?e:a,i[1]=p;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},9646:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>p,toc:()=>c});var n=r(7462),a=(r(7294),r(3905));const o={title:"How do AppRTC work in WebRTC mechanism?",description:"In this article, we illustrate how AppRTC do work.",keywords:["WebRTC"],sidebar_position:1},i="How do AppRTC work in WebRTC mechanism?",p={unversionedId:"web_rtc/2020.11.19.apprtc_tutorial",id:"web_rtc/2020.11.19.apprtc_tutorial",title:"How do AppRTC work in WebRTC mechanism?",description:"In this article, we illustrate how AppRTC do work.",source:"@site/docs/web_rtc/2020.11.19.apprtc_tutorial.md",sourceDirName:"web_rtc",slug:"/web_rtc/2020.11.19.apprtc_tutorial",permalink:"/docs/web_rtc/2020.11.19.apprtc_tutorial",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"How do AppRTC work in WebRTC mechanism?",description:"In this article, we illustrate how AppRTC do work.",keywords:["WebRTC"],sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"\u4f7f\u7528 TorchServe \u90e8\u7f72 Model",permalink:"/docs/torch/2020.11.04.torch_server_tutorial"}},l={},c=[{value:"WebSocket API",id:"websocket-api",level:4},{value:"HTTP API",id:"http-api",level:4}],s={toc:c},m="wrapper";function d(e){let{components:t,...r}=e;return(0,a.kt)(m,(0,n.Z)({},s,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"how-do-apprtc-work-in-webrtc-mechanism"},"How do AppRTC work in WebRTC mechanism?"),(0,a.kt)("p",null,"AppRTC is a WebRTC open source repo that implements two clients who can communicate with each other with webcam and voice. That works like a chatting room but only two persons in the room. When there have two clients in the room, they will exchange some messages for building a p2p connection and starting communication."),(0,a.kt)("p",null,"But it doesn\u2019t the whole WebRTC main mechanism that is only data exchange and manages the connection process. So AppRTC is a sample system when the coder implements WebRTC, help them decrease the development time."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/webrtc/apprtc"},"AppRTC Repo is here!")," ",(0,a.kt)("a",{parentName:"p",href:"https://www.w3.org/TR/webrtc/#peer-to-peer-connections"},"WebRTC mechanism"))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Manipulate AppRTC")," First, one client joins a room and waiting for the other client to join. At once, there are two clients in the room, they can chat with each other."),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn-images-1.medium.com/max/800/1*SBGnOfjTNDU7TciZLndoLg.gif",alt:null})),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"The AppRTC Implement ","(","not include p2p mechanism",")")," We divided into two part to illustrate AppRTC work. The first client join room and the second client join room."),(0,a.kt)("p",null,"The first client join room:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Get / for getting AppRTC home page.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Post /join/:room","_","id for registry room id into AppRTC and getting a Client ID to registry Signal Server.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Use Client ID to registry Signal Server ","(","Collider Server",")"),(0,a.kt)("p",{parentName:"li"},'send /ws {cmd: "register", "roomid":"", \u201cclientid\u201d: ""}')),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"POST /message/:room","_","id/:client","_","id for storing p2p connection message into AppRTC Server.","(","About sdp\u3001","(","ICE",")"," candidate messages",")")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Waiting another sdp and ","(","ICE",")"," Candidate message."))),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn-images-1.medium.com/max/800/1*d7Ukv4SqzjIzhaqObqWVJA.png",alt:null})),(0,a.kt)("p",null,"The second client join room:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Get / for getting AppRTC home page."),(0,a.kt)("li",{parentName:"ol"},"Post /join/:room","_","id for registry room id into AppRTC and getting a Client ID to registry Signal Server and ",(0,a.kt)("strong",{parentName:"li"},"first client p2p connection cache","(","sdp, ","(","ICE candidate",")")),(0,a.kt)("li",{parentName:"ol"},"According to cache generates a new p2p connection message and send it by WebSocket to the first client"),(0,a.kt)("li",{parentName:"ol"},"Two clients communicate with each other through p2p.")),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://cdn-images-1.medium.com/max/800/1*6QtDR_rI77tXj4lcQcM5nw.png",alt:null})),(0,a.kt)("p",null,"The Collider Server API"),(0,a.kt)("p",null,"The Collider server has two functions. one is HTTP, the other one is WebSocket. The WebSocket API is for the client to communicate with each other like registry and send these actions. The HTTP API is for AppRTC server sync room status."),(0,a.kt)("h4",{id:"websocket-api"},"WebSocket API"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"left"},"numbers"),(0,a.kt)("th",{parentName:"tr",align:"left"},"parameters"),(0,a.kt)("th",{parentName:"tr",align:"left"},"illustration"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"1"),(0,a.kt)("td",{parentName:"tr",align:"left"},'{cmd: "register", "roomid":"", "clientid": ""}'),(0,a.kt)("td",{parentName:"tr",align:"left"},"join room")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"2"),(0,a.kt)("td",{parentName:"tr",align:"left"},'{cmd: "send", "roomid":"", "clientid": "", "msg":"',(0,a.kt)("strong",{parentName:"td"},"JSON string"),'"}'),(0,a.kt)("td",{parentName:"tr",align:"left"},"send message to the other client")))),(0,a.kt)("h4",{id:"http-api"},"HTTP API"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"center"},"numbers"),(0,a.kt)("th",{parentName:"tr",align:"center"},"parameters"),(0,a.kt)("th",{parentName:"tr",align:"left"},"illustration"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"1"),(0,a.kt)("td",{parentName:"tr",align:"center"},"post /bye/:room","_","id:/:client","_","id"),(0,a.kt)("td",{parentName:"tr",align:"left"},"delete collider room status")))),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Conclusion")," ",(0,a.kt)("br",null),"In the AppRTC demo application, it follows ",(0,a.kt)("a",{parentName:"p",href:"https://medium.com/%E5%BE%AE%E5%B3%AF%E9%A3%9B%E7%BF%94/broker%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E9%BA%BC-707ddc05268a"},"Broker Architecture")," to coordinate p2p message exchange. Though the key-point is not ",(0,a.kt)("strong",{parentName:"p"},"the sdp and ","(","ICE",")"," candidate")," message exchanged method, but it still important to manage the exchange process. So if you read AppRTC open source, this article can help you modify this project."))}d.isMDXComponent=!0}}]);