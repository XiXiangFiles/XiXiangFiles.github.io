<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-k8s/2022.02.19.k8s_structure">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Kubernetes 架構 | jerry.wang&#x27;s blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wangs.cloud/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wangs.cloud/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wangs.cloud/docs/k8s/2022.02.19.k8s_structure"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kubernetes 架構 | jerry.wang&#x27;s blog"><meta data-rh="true" name="description" content="K8s 是一套 Ops (Operation) 的工具，DevOps 指的是開發部門與維運部門的整合(Dev + Ops)，然而由於實務上，往往開發速度 &gt; 維運部署的速度，因此 DevOps 的議題往往是產品開發的重點。GitOps 則是自動化部屬與整合的產物，搭配 Git Repository 工具使用，快速的將產品部署於 K8s cluster中。"><meta data-rh="true" property="og:description" content="K8s 是一套 Ops (Operation) 的工具，DevOps 指的是開發部門與維運部門的整合(Dev + Ops)，然而由於實務上，往往開發速度 &gt; 維運部署的速度，因此 DevOps 的議題往往是產品開發的重點。GitOps 則是自動化部屬與整合的產物，搭配 Git Repository 工具使用，快速的將產品部署於 K8s cluster中。"><meta data-rh="true" name="keywords" content="k8s"><link data-rh="true" rel="icon" href="/img/programmer.png"><link data-rh="true" rel="canonical" href="https://wangs.cloud/docs/k8s/2022.02.19.k8s_structure"><link data-rh="true" rel="alternate" href="https://wangs.cloud/docs/k8s/2022.02.19.k8s_structure" hreflang="en"><link data-rh="true" rel="alternate" href="https://wangs.cloud/docs/k8s/2022.02.19.k8s_structure" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CV3DEYG0V5"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-CV3DEYG0V5",{})</script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.21f63a90.css">
<link rel="preload" href="/assets/js/runtime~main.b3f86e02.js" as="script">
<link rel="preload" href="/assets/js/main.30932032.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Jerry.Wang Blog</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://www.linkedin.com/in/zi-xiang-wang-56073a1a2/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Jerry Wang Blog</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/golang/2021.10.23.advance_golang">Golang</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/database/2021.04.18.smalltalk_nosql">Database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/http/2020.11.25.overview_the_websocket_mechanism">HTTP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/patterns/2021.09.04.from_mod_to_structure">Pattern</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/broker/2020.11.11.what_is_broker">Broker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/blockchain/2021.03.07.blockchain_issues">Blockchain</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/k8s/2022.02.14.shorttalk_k8s">Kubernetes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/k8s/2022.02.14.shorttalk_k8s">Kubernetes 超入門</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/k8s/2022.02.19.k8s_structure">Kubernetes 架構</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/k8s/2022.03.20.k8s.devops">K8s 在 DevOps 中的作用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/k8s/2022.04.30.distribution_forces">分散式系統: 現代軟體架構與設計考量</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/k8s/2023.09.17.raspberry_pi_with_k3d">使用 K3d 在 要在 Raspberry Pi4 筆記</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/security/2020.12.20.auth_2_tutorial">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/torch/2020.11.04.torch_server_tutorial">Torch</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/web_rtc/2020.11.19.apprtc_tutorial">WebRTC</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Kubernetes</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Kubernetes 架構</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Kubernetes 架構</h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="overview-kubernetes-架構">Overview Kubernetes 架構<a href="#overview-kubernetes-架構" class="hash-link" aria-label="Direct link to Overview Kubernetes 架構" title="Direct link to Overview Kubernetes 架構">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="以components-角度看kubernetes">以Components 角度看Kubernetes<a href="#以components-角度看kubernetes" class="hash-link" aria-label="Direct link to 以Components 角度看Kubernetes" title="Direct link to 以Components 角度看Kubernetes">​</a></h4><ul><li>Control Pane:用於管理其他Node、Service、Pod的工具，是由K8s Server擁有，也可以透過該原件排程等等。</li><li>DNS Server: 賦予Node、Service、Pod的Domain Name。</li><li>Kubelete: Node 透過該工具去管理Node 中的Service、Pod。</li><li>etcd: 儲存各種k8s的狀態。</li><li>Kube Proxy: 用於管理除了Server Node Network。</li></ul><p><img loading="lazy" alt="K8s 架構" src="/assets/images/image (22) (1) (1) (1) (1) (1) (1)-82ac7d83fbb9474171f33adb4884669d.png" width="481" height="276" class="img_ev3q"></p><p>在K8s 分成兩種Node，K8s Server 與 agent兩種<!-- -->[<!-- -->5]，<em><strong>差別在於是否具有權限管理其他的Node</strong></em>，也就是是否具有Control Pane 元件的Node。而Control Pane 主要能夠透過kubelete 去操作其他的Node中的Pod、Service...等等。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="以服務角度看kubernetes"><strong>以服務角度看Kubernetes</strong><a href="#以服務角度看kubernetes" class="hash-link" aria-label="Direct link to 以服務角度看kubernetes" title="Direct link to 以服務角度看kubernetes">​</a></h4><p>在K8s定義下，Service 是抽象化一群Pod的意思，舉個例子一套系統會有各種DB、Message Queue、Functionalities 共由三個Pod，使用者可以定義這三個Pod 作為一組Service，稱Backend Service。</p><p><img loading="lazy" alt="Service In K8s " src="/assets/images/image (21) (1) (1) (1) (1) (1) (1)-52d1c68d71403db895b24c6e2ac1c14b.png" width="680" height="515" class="img_ev3q"></p><p>然而在實際的應用是由多個 Service 組成，像是一般網站至少有兩個Service，Frontend Service、Backend Service，以下圖為例，在k8s要組成一個應用則會有多個Service相互作用才能達成。</p><p><img loading="lazy" alt="A Service" src="data:image/png;base64,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" width="390" height="218" class="img_ev3q"></p><p>Service 主要分成四種網路型態<!-- -->[<!-- -->1]:</p><ul><li>ClusterIP: Exposes the Service on a cluster-internal IP.</li><li>NodePort: Exposes the Service on each Node&#x27;s IP at a static port (the <code>NodePort</code>).<!-- --> </li><li>LoadBalancer:Exposes the Service externally using a cloud provider&#x27;s load balancer</li><li>ExternalName:Maps the Service to the contents of the <code>externalName</code> field</li></ul><p><strong>網路狀態看Kubernetes</strong> </p><p>對於開發服務的工程師而言，各Container其實才是真的功能面的最小單位，如http, ssh, mqtt等。在k8s 中是把一群的container 視為最小單位(Pod)，換句話說以<strong>維運</strong>的角度整體服務才是最小單位。因此k8s 需要Mapping機制使得Container, Pod, Service 這之間可以對的上。以下圖為例，<strong>k8s 中共分成3個component分別為Container, Pod, Service。在Container 的部分維運者需要為各功能取名，如http, mqtt, ssh 等功能名稱於Pod 設定檔，此時的Pod 就被視為一個單一功能。</strong><em><strong>而Service則會將這些功能組合成一個服務，透過Mapping Pod 中所定義的名稱、Port組合</strong></em><strong>。最後將服務的存取位置釋放給Node，也就是Endpoint 設定。</strong></p><p><img loading="lazy" alt="k8s Node網路結構" src="/assets/images/image (21) (1) (1)-3f828aaf6ad88968722d54b6dfd603db.png" width="639" height="531" class="img_ev3q"></p><p>對於在k8s 中除了Node 內部網路的設定，也還包含Cluster 中 Node 網路的設定，也就是 Ingress 。</p><p>Ingress 使用於External Client 實際Query 的請求Route，Client 不用特別指定使用的機器，而是開發者事先設定Cluster 的Routing。可參考下圖示例。</p><p><img loading="lazy" alt="how ingress do work?" src="/assets/images/image (24) (1) (1) (1) (1)-2d9ecec440ede7cd7d3cd03b312eb307.png" width="697" height="427" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="範例實作">範例實作<a href="#範例實作" class="hash-link" aria-label="Direct link to 範例實作" title="Direct link to 範例實作">​</a></h3><p>由於k8s 本身的硬體需求比較龐大，因此各家機構紛紛推出自己的k8s開放工具，如Ubuntu基金會的Micro-K8s 或者 Rancher 的 k3s...等等，本範例使用k3s 進行解說，測試環境作業系統為ubuntu 20.04。共解說兩個範例1. Run A Service in K8s, 2. Run A Service in k8s agent。</p><p><strong>K8s ymal 檔案主要有幾個必填項目：</strong></p><ul><li><code>apiVersion</code> - Which version of the Kubernetes API you&#x27;re using to create this object</li><li><code>kind</code> - What kind of object you want to create</li><li><code>metadata</code> - Data that helps uniquely identify the object, including a <code>name</code> string, <code>UID</code>, and optional <code>namespace</code></li><li><code>spec</code> - What state you desire for the object</li></ul><p><strong>Attachment(1) nginx Pod config</strong></p><p>其中 pod中的 labels 非常重要，這裡決定Service 的selector 中要完全一樣才能夠成功mapping.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">labels</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">containers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">1.14.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="attachement2-nginx-serivce-config">Attachement(2) nginx Serivce config<a href="#attachement2-nginx-serivce-config" class="hash-link" aria-label="Direct link to Attachement(2) nginx Serivce config" title="Direct link to Attachement(2) nginx Serivce config">​</a></h4><p>Service 中 selector 指的是所選擇的Pod 名稱，然而也可以選擇多個但以下範例只填一個。在Service yaml 檔案中，需要住要 type 欄位，如果選擇NodePort 可以供外部電腦存取。</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> my</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> NodePort</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">selector</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">app</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> nginx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">protocol</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> TCP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">port</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">targetPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">nodePort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30390</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="執行-pod"><strong>執行 pod</strong><a href="#執行-pod" class="hash-link" aria-label="Direct link to 執行-pod" title="Direct link to 執行-pod">​</a></h4><div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> kubectl apply -f nginx-pod.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="執行service">執行service<a href="#執行service" class="hash-link" aria-label="Direct link to 執行service" title="Direct link to 執行service">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo kubectl apply -f nginx-service.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="describe-service">Describe Service<a href="#describe-service" class="hash-link" aria-label="Direct link to Describe Service" title="Direct link to Describe Service">​</a></h4><p><img loading="lazy" src="/assets/images/image (23) (1) (1) (1) (1) (1)-0a53901ef63cc3d7f3484d1512c4cd79.png" width="397" height="290" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="test">Test<a href="#test" class="hash-link" aria-label="Direct link to Test" title="Direct link to Test">​</a></h4><ul><li>curl 10.42.0.50.80 -&gt; 透過Endpoint : port 由server 內部進入</li></ul><p><img loading="lazy" src="/assets/images/image (19)-a2dd19ba9639bbe4d6389fe801285261.png" width="610" height="414" class="img_ev3q"></p><ul><li>curl 172.20.10.3:30390 -&gt; curl external ip : nodePort</li></ul><p><img loading="lazy" src="/assets/images/image (24) (1) (1) (1)-5326aed59308d958d5ab890ca01b0b8f.png" width="611" height="419" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reference">Reference<a href="#reference" class="hash-link" aria-label="Direct link to Reference" title="Direct link to Reference">​</a></h3><p>[1][https://kubernetes.io/docs/concepts/services-networking/service/]<!-- -->(<a href="https://kubernetes.io/docs/concepts/services-networking/service/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/concepts/services-networking/service/</a>)<br>
<!-- -->[2][https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#spec-and-status]<!-- -->(<a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#spec-and-status" target="_blank" rel="noopener noreferrer">https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#spec-and-status</a>)<br>
<!-- -->[3][https://rancher.com/docs/k3s/latest/]<!-- -->(<a href="https://rancher.com/docs/k3s/latest/" target="_blank" rel="noopener noreferrer">https://rancher.com/docs/k3s/latest/</a>)<br>
<!-- -->[4]<!-- --> Luksa, Marko. <em>Kubernetes in action</em>. Simon and Schuster, 2017.<br>
<!-- -->[5][https://k3s.io/]<!-- -->(<a href="https://k3s.io/" target="_blank" rel="noopener noreferrer">https://k3s.io/</a>)<br></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/k8s/2022.02.14.shorttalk_k8s"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Kubernetes 超入門</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/k8s/2022.03.20.k8s.devops"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">K8s 在 DevOps 中的作用</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview-kubernetes-架構" class="table-of-contents__link toc-highlight">Overview Kubernetes 架構</a></li><li><a href="#範例實作" class="table-of-contents__link toc-highlight">範例實作</a></li><li><a href="#reference" class="table-of-contents__link toc-highlight">Reference</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Jerry.wang blog, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b3f86e02.js"></script>
<script src="/assets/js/main.30932032.js"></script>
</body>
</html>